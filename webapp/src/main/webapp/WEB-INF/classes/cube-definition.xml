<?xml version="1.0" encoding="UTF-8"?>
<Schema name="pg_CLC_90_00">
   
    <!-- Shared dimensions -->

        <Dimension name="CHANGES">
            <Hierarchy name="CHANGES" hasAll="true" allMemberName="All changes" primaryKey="change_code" primaryKeyTable="change_codes_v13_3dates">
                <Table name="change_codes_v13_3dates"/>
                <Level name="CHANGES" table="change_codes_v13_3dates" column="change" uniqueMembers="false"/>
            </Hierarchy>
        </Dimension>

        <Dimension name="LAND COVER FLOWS">
            <Hierarchy name="LCF" hasAll="true" allMemberName="All Land Cover Flows" primaryKey="change_code" primaryKeyTable="change_codes_v13_3dates">
                <Join leftKey="lcf3" rightKey="lcf3_code">
                  <Table name="change_codes_v13_3dates"/>
                  <Table name="defs_lcf_3_dates"/>
                </Join>
                <Level name="LCF LEVEL 1" table="defs_lcf_3_dates" column="lcf1_name" uniqueMembers="false"/>
                <Level name="LCF LEVEL 2" table="defs_lcf_3_dates" column="lcf2_name" uniqueMembers="false"/>
                <Level name="LCF LEVEL 3" table="defs_lcf_3_dates" column="lcf3_name" uniqueMembers="true"/>
            </Hierarchy>
        </Dimension>

        <Dimension name="LAND COVER 90">
            <Hierarchy name="CLC_90" hasAll="true" allMemberName="All Land Covers 90" primaryKey="change_code" primaryKeyTable="change_codes_v13_3dates">
                <Join leftKey="lc1" rightKey="level3_code">
                  <Table name="change_codes_v13_3dates"/>
                  <Table name="defs_clc_06v13"/>
                </Join>
                <Level name="CLC90 LEVEL 1" table="defs_clc_06v13" column="l1_all" uniqueMembers="false"/>
                <Level name="CLC90 LEVEL 2" table="defs_clc_06v13" column="l2_all" uniqueMembers="false"/>
                <Level name="CLC90 LEVEL 3" table="defs_clc_06v13" column="l3_all" uniqueMembers="true"/>
            </Hierarchy>
        </Dimension>

        <Dimension name="LAND COVER 00">
            <Hierarchy name="CLC_00" hasAll="true" allMemberName="All Land Covers 00" primaryKey="change_code" primaryKeyTable="change_codes_v13_3dates">
                <Join leftKey="lc2" rightKey="level3_code">
                  <Table name="change_codes_v13_3dates"/>
                  <Table name="defs_clc_06v13"/>
                </Join>
                <Level name="CLC00 LEVEL 1" table="defs_clc_06v13" column="l1_all" uniqueMembers="false"/>
                <Level name="CLC00 LEVEL 2" table="defs_clc_06v13" column="l2_all" uniqueMembers="false"/>
                <Level name="CLC00 LEVEL 3" table="defs_clc_06v13" column="l3_all" uniqueMembers="true"/>
            </Hierarchy>
        </Dimension>
		<!-- Note that this definition uses the same tables and fields as  identical "LAND COVER 00".
		     This is CORRECT, as the right foreign key on the fact table is layer chosen using the
		     DimensionUsage element.
		-->
        <Dimension name="LAND COVER 06">
            <Hierarchy name="CLC_06" hasAll="true" allMemberName="All Land Covers 06" primaryKey="change_code" primaryKeyTable="change_codes_v13_3dates">
                <Join leftKey="lc2" rightKey="level3_code">
                  <Table name="change_codes_v13_3dates"/>
                  <Table name="defs_clc_06v13"/>
                </Join>
                <Level name="CLC06 LEVEL 1" table="defs_clc_06v13" column="l1_all" uniqueMembers="false"/>
                <Level name="CLC06 LEVEL 2" table="defs_clc_06v13" column="l2_all" uniqueMembers="false"/>
                <Level name="CLC06 LEVEL 3" table="defs_clc_06v13" column="l3_all" uniqueMembers="true"/>
            </Hierarchy>
        </Dimension>

    <!-- Here starts the definition of the cubes -->

    <Cube name="pg_CLC_90_00" enabled="true">
        <Table name="es013_espon_june013_3" />

        <Dimension name="NUTS 2010" foreignKey="prox_nuts10">
            <Hierarchy name="NUTS 2010" hasAll="true" allMemberName="All NUTS 2010" primaryKey="id">
                <Table name="es013_n10"/>
                <Level name="NUTS 2010 LEVEL 0" table="es013_n10" column="n0c_nm" uniqueMembers="false">
                    <Property name="geom" column="the_geom_l0" type="Geometry" />
                    <Property name="pointgeom" column="the_geom_baryc_l0" type="Geometry" />
                </Level>
                <Level name="NUTS 2010 LEVEL 1" table="es013_n10" column="n1c_nm" uniqueMembers="false">
                    <Property name="geom" column="the_geom_l1" type="Geometry" />
                    <Property name="pointgeom" column="the_geom_baryc_l1" type="Geometry" />
                </Level>
                <Level name="NUTS 2010 LEVEL 2" table="es013_n10" column="n2c_nm" uniqueMembers="false">
                    <Property name="geom" column="the_geom_l2" type="Geometry" />
                    <Property name="pointgeom" column="the_geom_baryc_l2" type="Geometry" />
                </Level>
                <Level name="NUTS 2010 LEVEL 3" table="es013_n10" column="n3c_nm" uniqueMembers="true">
                    <Property name="geom" column="the_geom_l3" type="Geometry" />
                    <Property name="pointgeom" column="the_geom_baryc_l3" type="Geometry" />
                </Level>
            </Hierarchy>
        </Dimension>

        <Dimension name="NUTS 2006" foreignKey="prox_nuts06">
            <Hierarchy name="NUTS 2006" hasAll="true" allMemberName="All NUTS 2006" primaryKey="id">
                <Table name="es013_n06"/>
                <Level name="NUTS 2006 LEVEL 0" table="es013_n06" column="n0c_nm" uniqueMembers="false">
                    <Property name="geom" column="the_geom_l0" type="Geometry" />
                    <Property name="pointgeom" column="the_geom_baryc_l0" type="Geometry" />
                </Level>
                <Level name="NUTS 2006 LEVEL 1" table="es013_n06" column="n1c_nm" uniqueMembers="false">
                    <Property name="geom" column="the_geom_l1" type="Geometry" />
                    <Property name="pointgeom" column="the_geom_baryc_l1" type="Geometry" />
                </Level>
                <Level name="NUTS 2006 LEVEL 2" table="es013_n06" column="n2c_nm" uniqueMembers="false">
                    <Property name="geom" column="the_geom_l2" type="Geometry" />
                    <Property name="pointgeom" column="the_geom_baryc_l2" type="Geometry" />
                </Level>
                <Level name="NUTS 2006 LEVEL 3" table="es013_n06" column="n3c_nm" uniqueMembers="true">
                    <Property name="geom" column="the_geom_l3" type="Geometry" />
                    <Property name="pointgeom" column="the_geom_baryc_l3" type="Geometry" />
                </Level>
            </Hierarchy>
        </Dimension>

        <Dimension name="NUTS 2003" foreignKey="prox_nuts03">
            <Hierarchy name="NUTS 2003" hasAll="true" allMemberName="All NUTS 2003" primaryKey="id">
                <Table name="es013_n03"/>
                <Level name="NUTS 2003 LEVEL 0" table="es013_n03" column="n0c_nm" uniqueMembers="false">
                    <Property name="geom" column="the_geom_l0" type="Geometry" />
                    <Property name="pointgeom" column="the_geom_baryc_l0" type="Geometry" />
                </Level>
                <Level name="NUTS 2003 LEVEL 1" table="es013_n03" column="n1c_nm" uniqueMembers="false">
                    <Property name="geom" column="the_geom_l1" type="Geometry" />
                    <Property name="pointgeom" column="the_geom_baryc_l1" type="Geometry" />
                </Level>
                <Level name="NUTS 2003 LEVEL 2" table="es013_n03" column="n2c_nm" uniqueMembers="false">
                    <Property name="geom" column="the_geom_l2" type="Geometry" />
                    <Property name="pointgeom" column="the_geom_baryc_l2" type="Geometry" />
                </Level>
                <Level name="NUTS 2003 LEVEL 3" table="es013_n03" column="n3c_nm" uniqueMembers="true">
                    <Property name="geom" column="the_geom_l3" type="Geometry" />
                    <Property name="pointgeom" column="the_geom_baryc_l3" type="Geometry" />
                </Level>
            </Hierarchy>
        </Dimension>
        
        <Dimension name="NUTS 1999" foreignKey="prox_nuts99">
            <Hierarchy name="NUTS 1999" hasAll="true" allMemberName="All NUTS 1999" primaryKey="id">
                <Table name="es013_n99"/>
                <Level name="NUTS 1999 LEVEL 0" table="es013_n99" column="n0c_nm" uniqueMembers="false">
                    <Property name="geom" column="the_geom_l0" type="Geometry" />
                    <Property name="pointgeom" column="the_geom_baryc_l0" type="Geometry" />
                </Level>
                <Level name="NUTS 1999 LEVEL 1" table="es013_n99" column="n1c_nm" uniqueMembers="false">
                    <Property name="geom" column="the_geom_l1" type="Geometry" />
                    <Property name="pointgeom" column="the_geom_baryc_l1" type="Geometry" />
                </Level>
                <Level name="NUTS 1999 LEVEL 2" table="es013_n99" column="n2c_nm" uniqueMembers="false">
                    <Property name="geom" column="the_geom_l2" type="Geometry" />
                    <Property name="pointgeom" column="the_geom_baryc_l2" type="Geometry" />
                </Level>
                <Level name="NUTS 1999 LEVEL 3" table="es013_n99" column="n3c_nm" uniqueMembers="true">
                    <Property name="geom" column="the_geom_l3" type="Geometry" />
                    <Property name="pointgeom" column="the_geom_baryc_l3" type="Geometry" />
                </Level>
            </Hierarchy>
        </Dimension>

    <Dimension name="LARGE URBAN ZONES 2012" foreignKey="luz12">
        <Hierarchy name="LUZ 2012" hasAll="true" allMemberName="All LUZ 2012" primaryKey="id">
            <Table name="es013_luz12"/>
            <Level name="LUZ 2012" table="es013_luz12" column="luzcnam" uniqueMembers="true">
                <Property name="geom" column="the_geom" type="Geometry" />
                <Property name="pointgeom" column="the_geom_baryc" type="Geometry" />
            </Level>
        </Hierarchy>
    </Dimension>
    <Dimension name="LARGE URBAN ZONES 2004" foreignKey="luz04">
        <Hierarchy name="LUZ" hasAll="true" allMemberName="All LUZ" primaryKey="id">
            <Table name="es013_luz04"/>
            <Level name="LUZ" table="es013_luz04" column="luzc_nm" uniqueMembers="true">
                <Property name="geom" column="the_geom" type="Geometry" />
                <Property name="pointgeom" column="the_geom_baryc" type="Geometry" />
            </Level>
        </Hierarchy>
    </Dimension>
    <Dimension name="URBAN MORPHOLOGICAL ZONES 2000" foreignKey="umz00">
        <Hierarchy name="UMZ 2000" hasAll="true" allMemberName="All UMZ 2000" primaryKey="id">
            <Table name="es013_umz00"/>
            <Level name="UMZ 2000" table="es013_umz00" column="cityname_0" uniqueMembers="true">
                <Property name="geom" column="the_geom" type="Geometry" />
                <Property name="pointgeom" column="the_geom_baryc" type="Geometry" />
            </Level>
        </Hierarchy>
    </Dimension>
    <Dimension name="FUNCTIONAL URBAN AREAS" foreignKey="fua">
        <Hierarchy name="FUA" hasAll="true" allMemberName="All FUA" primaryKey="id">
            <Table name="es013_def_fua"/>
            <Level name="FUA" table="es013_def_fua" column="unitc_name" uniqueMembers="true">
                <Property name="geom" column="the_geom" type="Geometry" />
                <Property name="pointgeom" column="the_geom_baryc" type="Geometry" />
            </Level>
        </Hierarchy>
    </Dimension>

    <Dimension name="MORPHOLOGICAL URBAN AREAS" foreignKey="mua">
        <Hierarchy name="MUA" hasAll="true" allMemberName="All MUA" primaryKey="id">
            <Table name="es013_def_mua"/>
            <Level name="MUA" table="es013_def_mua" column="code" uniqueMembers="true">
                <Property name="geom" column="the_geom" type="Geometry" />
                <Property name="pointgeom" column="the_geom_baryc" type="Geometry" />
            </Level>
        </Hierarchy>
    </Dimension>

        <!-- Add the shared dimensions to the cube -->
    <DimensionUsage name="LAND COVER 90" source="LAND COVER 90" foreignKey="ch90_00" />
	<DimensionUsage name="LAND COVER 00" source="LAND COVER 00" foreignKey="ch90_00" />
	<DimensionUsage name="LAND COVER 06" source="LAND COVER 06" foreignKey="ch00_06" />
	<DimensionUsage name="LAND COVER FLOWS 90-00" source="LAND COVER FLOWS" foreignKey="ch90_00" />
	<DimensionUsage name="LAND COVER FLOWS 00-06" source="LAND COVER FLOWS" foreignKey="ch00_06" />
	<DimensionUsage name="LAND COVER FLOWS 90-06" source="LAND COVER FLOWS" foreignKey="ch90_06" />	
	<DimensionUsage name="CHANGES 90-00" source="CHANGES" foreignKey="ch90_00" />
	<DimensionUsage name="CHANGES 00-06" source="CHANGES" foreignKey="ch00_06" />

	<!-- Definition of measures and calculated members -->

    <Measure name="Population 2009 (1000 inh.)" column="pop09" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="Population 2006 (1000 inh.)" column="pop06" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="Population 2003 (1000 inh.)" column="pop03" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="Population 2000 (1000 inh.)" column="pop00" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="GDP 2009 (in PPS)" column="pps09" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="GDP 2006 (in PPS)" column="pps06" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="GDP 2003 (in PPS)" column="pps03" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="GDP 2000 (in PPS)" column="pps00" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="GDP 2009 (million euro)" column="gdp09" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="GDP 2006 (million euro)" column="gdp06" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="GDP 2003 (million euro)" column="gdp03" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="GDP 2000 (million euro)" column="gdp00" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="Births 2009 (thousand)" column="birth09" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="Births 2006 (thousand)" column="birth06" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="Births 2003 (thousand)" column="birth03" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="Births 2000 (thousand)" column="birth00" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="Deaths 2009 (thousand)" column="death09" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="Deaths 2006 (thousand)" column="death06" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="Deaths 2003 (thousand)" column="death03" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="Deaths 2000 (thousand)" column="death00" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    
    <Measure name="Area (ha)" column="area" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    </Cube>

    <!-- Add support for geo-analytical operators brought by GeoMondrian -->
    <UserDefinedFunction name="ST_Contains" className="mondrian.udf.geo.STContainsUdf" />
    <UserDefinedFunction name="ST_Crosses" className="mondrian.udf.geo.STCrossesUdf" />
    <UserDefinedFunction name="ST_Disjoint" className="mondrian.udf.geo.STDisjointUdf" />
    <UserDefinedFunction name="ST_Equals" className="mondrian.udf.geo.STEqualsUdf" />
    <UserDefinedFunction name="ST_Intersects" className="mondrian.udf.geo.STIntersectsUdf" />
    <UserDefinedFunction name="ST_Overlaps" className="mondrian.udf.geo.STOverlapsUdf" />
    <UserDefinedFunction name="ST_Touches" className="mondrian.udf.geo.STTouchesUdf" />
    <UserDefinedFunction name="ST_Within" className="mondrian.udf.geo.STWithinUdf" />
    <UserDefinedFunction name="ST_Relate" className="mondrian.udf.geo.STRelateUdf" />
    <UserDefinedFunction name="ST_Distance" className="mondrian.udf.geo.STDistanceUdf" />
    <UserDefinedFunction name="ST_GeomFromText" className="mondrian.udf.geo.STGeomFromTextUdf" />
    <UserDefinedFunction name="ST_UnionAgg" className="mondrian.udf.geo.STUnionAggUdf" />

</Schema>
