<?xml version="1.0" encoding="UTF-8"?>
<Schema name="pg_CLC_90_00">
   
    <!-- Shared dimensions -->

        <Dimension name="CHANGES">
            <Hierarchy name="CHANGES" hasAll="true" allMemberName="All changes" primaryKey="change_code" primaryKeyTable="change_codes_v13_3dates">
                <Table name="change_codes_v13_3dates"/>
                <Level name="CHANGES" table="change_codes_v13_3dates" column="change" uniqueMembers="false"/>
            </Hierarchy>
        </Dimension>

        <Dimension name="LAND COVER FLOWS">
            <Hierarchy name="LCF" hasAll="true" allMemberName="All Land Cover Flows" primaryKey="change_code" primaryKeyTable="change_codes_v13_3dates">
                <Join leftKey="lcf3" rightKey="lcf3_code">
                  <Table name="change_codes_v13_3dates"/>
                  <Table name="defs_lcf_3_dates"/>
                </Join>
                <Level name="LCF LEVEL 1" table="defs_lcf_3_dates" column="lcf1_name" uniqueMembers="false"/>
                <Level name="LCF LEVEL 2" table="defs_lcf_3_dates" column="lcf2_name" uniqueMembers="false"/>
                <Level name="LCF LEVEL 3" table="defs_lcf_3_dates" column="lcf3_name" uniqueMembers="true"/>
            </Hierarchy>
        </Dimension>

        <Dimension name="LAND COVER 90">
            <Hierarchy name="CLC_90" hasAll="true" allMemberName="All Land Covers 90" primaryKey="change_code" primaryKeyTable="change_codes_v13_3dates">
                <Join leftKey="lc1" rightKey="level3_code">
                  <Table name="change_codes_v13_3dates"/>
                  <Table name="defs_clc_06v13"/>
                </Join>
                <Level name="CLC90 LEVEL 1" table="defs_clc_06v13" column="l1_all" uniqueMembers="false"/>
                <Level name="CLC90 LEVEL 2" table="defs_clc_06v13" column="l2_all" uniqueMembers="false"/>
                <Level name="CLC90 LEVEL 3" table="defs_clc_06v13" column="l3_all" uniqueMembers="true"/>
            </Hierarchy>
        </Dimension>

        <Dimension name="LAND COVER 00">
            <Hierarchy name="CLC_00" hasAll="true" allMemberName="All Land Covers 00" primaryKey="change_code" primaryKeyTable="change_codes_v13_3dates">
                <Join leftKey="lc2" rightKey="level3_code">
                  <Table name="change_codes_v13_3dates"/>
                  <Table name="defs_clc_06v13"/>
                </Join>
                <Level name="CLC00 LEVEL 1" table="defs_clc_06v13" column="l1_all" uniqueMembers="false"/>
                <Level name="CLC00 LEVEL 2" table="defs_clc_06v13" column="l2_all" uniqueMembers="false"/>
                <Level name="CLC00 LEVEL 3" table="defs_clc_06v13" column="l3_all" uniqueMembers="true"/>
            </Hierarchy>
        </Dimension>
		<!-- Note that this definition uses the same tables and fields as  identical "LAND COVER 00".
		     This is CORRECT, as the right foreign key on the fact table is layer chosen using the
		     DimensionUsage element.
		-->
        <Dimension name="LAND COVER 06">
            <Hierarchy name="CLC_06" hasAll="true" allMemberName="All Land Covers 06" primaryKey="change_code" primaryKeyTable="change_codes_v13_3dates">
                <Join leftKey="lc2" rightKey="level3_code">
                  <Table name="change_codes_v13_3dates"/>
                  <Table name="defs_clc_06v13"/>
                </Join>
                <Level name="CLC06 LEVEL 1" table="defs_clc_06v13" column="l1_all" uniqueMembers="false"/>
                <Level name="CLC06 LEVEL 2" table="defs_clc_06v13" column="l2_all" uniqueMembers="false"/>
                <Level name="CLC06 LEVEL 3" table="defs_clc_06v13" column="l3_all" uniqueMembers="true"/>
            </Hierarchy>
        </Dimension>

    <!-- Here starts the definition of the cubes -->

    <Cube name="pg_CLC_90_00" enabled="true">
        <Table name="e012_nov2012_2" />

        <Dimension name="NUTS 2006" foreignKey="prox_n06">
            <Hierarchy name="NUTS" hasAll="true" allMemberName="All NUTS" primaryKey="fid_">
                <Table name="e012_n06"/>
                <Level name="NUTS 2006 LEVEL 0" table="e012_n06" column="n0c_nm" uniqueMembers="false">
                    <Property name="pointgeom" column="the_geom_baryc_n0" type="Geometry" />
                </Level>
                <Level name="NUTS 2006 LEVEL 1" table="e012_n06" column="n0c_nm" uniqueMembers="false">
                    <Property name="pointgeom" column="the_geom_baryc_n1" type="Geometry" />
                </Level>
                <Level name="NUTS 2006 LEVEL 2" table="e012_n06" column="n0c_nm" uniqueMembers="false">
                    <Property name="pointgeom" column="the_geom_baryc_n2" type="Geometry" />
                </Level>
                <Level name="NUTS 2006 LEVEL 3" table="e012_n06" column="n0c_nm" uniqueMembers="true">
                    <Property name="pointgeom" column="the_geom_baryc_n3" type="Geometry" />
                </Level>
            </Hierarchy>
        </Dimension>

    <!-- CMI: Commented out till we solve a problem with Belgium - BE???? geometry 
    <Dimension name="NUTS 2003" foreignKey="nuts03_id">
        <Hierarchy name="NUTS" hasAll="true" allMemberName="All NUTS" primaryKey="n3_id_2003">
            <Table name="defs_nuts_2003v13"/>
            <Level name="NUTS 2003 LEVEL 0" table="defs_nuts_2003v13" column="n0_cdnmen" uniqueMembers="false">
                <Property name="geom" column="the_geom_n0" type="Geometry" />
                <Property name="pointgeom" column="the_geom_baryc_n0" type="Geometry" />
            </Level>
            <Level name="NUTS 2003 LEVEL 1" table="defs_nuts_2003v13" column="n1_cdnm" uniqueMembers="false">
                <Property name="geom" column="the_geom_n1" type="Geometry" />
                <Property name="pointgeom" column="the_geom_baryc_n1" type="Geometry" />
            </Level>
            <Level name="NUTS 2003 LEVEL 2" table="defs_nuts_2003v13" column="n2_cdnm" uniqueMembers="false">
                <Property name="geom" column="the_geom_n2" type="Geometry" />
                <Property name="pointgeom" column="the_geom_baryc_n2" type="Geometry" />
            </Level>
            <Level name="NUTS 2003 LEVEL 3" table="defs_nuts_2003v13" column="n3_cdnm" uniqueMembers="true">
                <Property name="geom" column="the_geom_n3" type="Geometry" />
                <Property name="pointgeom" column="the_geom_baryc_n3" type="Geometry" />
            </Level>
        </Hierarchy>
    </Dimension>
    -->

    <Dimension name="ELEVATION BREAKDOWN" foreignKey="ebk0">
        <Hierarchy name="EBK" hasAll="true" allMemberName="All Elevation Breakdowns" primaryKey="ebk_id">
            <Table name="defs_ebkv13"/>
            <Level name="ELEVATION BREAKDOWN" table="defs_ebkv13" column="ebk_nm" uniqueMembers="true">
            	<!--
                <Property name="pointgeom" column="the_geom_baryc" type="Geometry" />
               -->
            </Level>
        </Hierarchy>
    </Dimension>
<!--
    <Dimension name="LARGE URBAN ZONES" foreignKey="luz_ndt">
        <Hierarchy name="LUZ" hasAll="true" allMemberName="All LUZ" primaryKey="grid_id">
            <Table name="es012_luz"/>
            <Level name="LUZ" table="es012_luz" column="luz_name" uniqueMembers="true">
                <Property name="pointgeom" column="the_geom_baryc" type="Geometry" />
            </Level>
        </Hierarchy>
    </Dimension> -->

        <!-- Add the shared dimensions to the cube -->
    <DimensionUsage name="LAND COVER 90" source="LAND COVER 90" foreignKey="ch90_00" />
	<DimensionUsage name="LAND COVER 00" source="LAND COVER 00" foreignKey="ch90_00" />
	<DimensionUsage name="LAND COVER 06" source="LAND COVER 06" foreignKey="ch00_06" />
	<DimensionUsage name="LAND COVER FLOWS 90-00" source="LAND COVER FLOWS" foreignKey="ch90_00" />
	<DimensionUsage name="LAND COVER FLOWS 00-06" source="LAND COVER FLOWS" foreignKey="ch00_06" />
	<DimensionUsage name="LAND COVER FLOWS 90-06" source="LAND COVER FLOWS" foreignKey="ch90_06" />	
	<DimensionUsage name="CHANGES 90-00" source="CHANGES" foreignKey="ch90_00" />
	<DimensionUsage name="CHANGES 00-06" source="CHANGES" foreignKey="ch00_06" />

	<!-- Definition of measures and calculated members -->
    <Measure name="AREA (Ha)" column="area" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="POPULATION 2011 (1000 inh.)" column="pop11p" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="POPULATION 2010 (1000 inh.)" column="pop10p" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="POPULATION 2009 (1000 inh.)" column="pop09p" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="POPULATION 2008 (1000 inh.)" column="pop08p" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="POPULATION 2007 (1000 inh.)" column="pop07p" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="POPULATION 2006 (1000 inh.)" column="pop06p" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="POPULATION 2005 (1000 inh.)" column="pop05p" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="POPULATION 2004 (1000 inh.)" column="pop04p" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="POPULATION 2003 (1000 inh.)" column="pop03p" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="POPULATION 2002 (1000 inh.)" column="pop02p" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="POPULATION 2001 (1000 inh.)" column="pop01p" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>
    <Measure name="POPULATION 2000 (1000 inh.)" column="pop00p" aggregator="sum" datatype="Numeric" formatString="#,##0.0"/>    </Cube>

    <!-- Add support for geo-analytical operators brought by GeoMondrian -->
    <UserDefinedFunction name="ST_Contains" className="mondrian.udf.geo.STContainsUdf" />
    <UserDefinedFunction name="ST_Crosses" className="mondrian.udf.geo.STCrossesUdf" />
    <UserDefinedFunction name="ST_Disjoint" className="mondrian.udf.geo.STDisjointUdf" />
    <UserDefinedFunction name="ST_Equals" className="mondrian.udf.geo.STEqualsUdf" />
    <UserDefinedFunction name="ST_Intersects" className="mondrian.udf.geo.STIntersectsUdf" />
    <UserDefinedFunction name="ST_Overlaps" className="mondrian.udf.geo.STOverlapsUdf" />
    <UserDefinedFunction name="ST_Touches" className="mondrian.udf.geo.STTouchesUdf" />
    <UserDefinedFunction name="ST_Within" className="mondrian.udf.geo.STWithinUdf" />
    <UserDefinedFunction name="ST_Relate" className="mondrian.udf.geo.STRelateUdf" />
    <UserDefinedFunction name="ST_Distance" className="mondrian.udf.geo.STDistanceUdf" />
    <UserDefinedFunction name="ST_GeomFromText" className="mondrian.udf.geo.STGeomFromTextUdf" />
    <UserDefinedFunction name="ST_UnionAgg" className="mondrian.udf.geo.STUnionAggUdf" />

</Schema>
